<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RDBHuB4u Admin Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1d29;
            color: #fff;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px 40px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 32px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 40px;
            height: 40px;
            background: #fff;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .connection-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            margin-left: 20px;
        }

        .connection-status.online {
            background: #4CAF50;
        }

        .connection-status.offline {
            background: #f44336;
        }

        .nav-tabs {
            background: #252936;
            padding: 0 40px;
            display: flex;
            gap: 10px;
            border-bottom: 2px solid #333;
        }

        .tab-btn {
            padding: 15px 30px;
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
            position: relative;
        }

        .tab-btn.active {
            color: #667eea;
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #667eea;
        }

        .tab-btn:hover {
            color: #667eea;
        }

        .container {
            padding: 40px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: #252936;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.3s;
            border: 2px solid transparent;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
        }

        .stat-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #667eea;
        }

        .stat-number {
            font-size: 42px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #fff;
        }

        .stat-label {
            color: #999;
            font-size: 16px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: #667eea;
            color: #fff;
        }

        .btn-primary:hover:not(:disabled) {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .search-box {
            padding: 12px 20px;
            background: #252936;
            border: 2px solid #333;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            width: 300px;
        }

        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 25px;
        }

        .content-card {
            background: #252936;
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .content-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
        }

        .content-img {
            width: 100%;
            height: 280px;
            object-fit: cover;
            background: #333;
        }

        .content-info {
            padding: 15px;
        }

        .content-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .content-meta {
            font-size: 14px;
            color: #999;
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .content-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 14px;
            flex: 1;
        }

        .btn-edit {
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-edit:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-delete {
            background: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-delete:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #252936;
            padding: 30px;
            border-radius: 12px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid #667eea;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
        }

        .modal-header h2 {
            font-size: 24px;
            color: #667eea;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            color: #999;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close-btn:hover {
            color: #fff;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #999;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            background: #1a1d29;
            border: 2px solid #333;
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
            grid-column: 1 / -1;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            grid-column: 1 / -1;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .success-message {
            background: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        .error-message {
            background: #f44336;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .image-preview {
            margin-top: 10px;
            max-width: 200px;
            max-height: 280px;
            border-radius: 8px;
            display: none;
            object-fit: cover;
            border: 2px solid #333;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
        }

        .category-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .category-tag {
            background: #667eea;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-tag button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 16px;
            padding: 0;
        }

        .episode-section {
            background: #1a1d29;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 2px solid #333;
        }

        .episode-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .quality-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .quality-input {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .quality-input label {
            font-size: 12px;
            color: #999;
        }

        .quality-input input {
            padding: 8px;
            font-size: 13px;
        }

        .add-episode-btn {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .add-episode-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .remove-episode-btn {
            background: #f44336;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .remove-episode-btn:hover {
            background: #d32f2f;
        }

        .spinner {
            border: 3px solid #333;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ZIP Download Styles */
        .zip-download-section {
            background: #1a1d29;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #333;
        }

        .zip-quality-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .zip-quality-btn {
            padding: 8px 16px;
            background: #333;
            border: none;
            border-radius: 6px;
            color: #999;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .zip-quality-btn.active {
            background: #667eea;
            color: white;
        }

        .zip-quality-btn:hover {
            background: #5568d3;
            color: white;
        }

        .zip-option {
            display: none;
        }

        .zip-option.active {
            display: block;
        }

        .zip-note {
            color: #999;
            font-size: 13px;
            margin-top: 10px;
            padding: 10px;
            background: #252936;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }

        .zip-size-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .zip-size-input input {
            flex: 1;
        }

        .zip-size-input select {
            width: 100px;
        }

        .modal-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }

        .modal-tab {
            padding: 10px 20px;
            background: #1a1d29;
            border: none;
            border-radius: 6px;
            color: #999;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-tab.active {
            background: #667eea;
            color: white;
        }

        .modal-tab:hover {
            background: #5568d3;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .episode-download-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background: #252936;
            border-radius: 6px;
        }

        .episode-download-item input[type="text"] {
            flex: 1;
            padding: 8px;
            background: #1a1d29;
            border: 1px solid #333;
            border-radius: 4px;
            color: white;
        }

        .delete-quality-btn {
            background: #f44336;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
        }

        .quality-badge {
            display: inline-block;
            padding: 4px 8px;
            background: #667eea;
            color: white;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        .content-type-filter {
            padding: 10px 15px;
            background: #252936;
            border: 2px solid #333;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            cursor: pointer;
        }

        .content-type-filter:focus {
            outline: none;
            border-color: #667eea;
        }

        .refresh-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .refresh-btn:hover {
            background: #45a049;
            transform: rotate(45deg);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-featured {
            background: #ff9800;
            color: black;
        }

        .status-regular {
            background: #2196F3;
            color: white;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 16px;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #333;
        }

        .pagination-btn {
            padding: 8px 16px;
            background: #252936;
            border: 2px solid #333;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pagination-btn:hover:not(:disabled) {
            border-color: #667eea;
            background: #667eea;
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-info {
            color: #999;
            font-size: 14px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
            }
            
            .header h1 {
                font-size: 24px;
                flex-wrap: wrap;
            }
            
            .nav-tabs {
                padding: 0 20px;
                flex-wrap: wrap;
            }
            
            .tab-btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .container {
                padding: 20px;
            }
            
            .content-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .content-img {
                height: 200px;
            }
            
            .modal-content {
                padding: 20px;
                margin: 10px;
            }
            
            .quality-inputs {
                grid-template-columns: 1fr;
            }
            
            .search-box {
                width: 100%;
            }
            
            .action-bar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .content-type-filter {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .content-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-content {
                padding: 15px;
            }
            
            .modal-header h2 {
                font-size: 20px;
            }
        }
        
        /* NEW: Space adjustment for Add Content button */
        .add-content-container {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #333;
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>
            <span class="logo">üé¨</span>
            RDBHuB4u Admin Panel
            <span class="connection-status" id="connectionStatus">‚ö° Checking...</span>
        </h1>
    </div>

    <div class="nav-tabs">
        <button class="tab-btn active" data-tab="dashboard">üìä Dashboard</button>
        <button class="tab-btn" data-tab="add">‚ûï Add Content</button>
        <button class="tab-btn" data-tab="manage">üìã Manage Content</button>
    </div>

    <div class="container">
        <div class="content-section active" id="dashboard">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üé¨</div>
                    <div class="stat-number" id="moviesCount">0</div>
                    <div class="stat-label">Movies</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üéå</div>
                    <div class="stat-number" id="animeCount">0</div>
                    <div class="stat-label">Anime</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üì∫</div>
                    <div class="stat-number" id="webseriesCount">0</div>
                    <div class="stat-label">WebSeries</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üíæ</div>
                    <div class="stat-number" id="totalCount">0</div>
                    <div class="stat-label">Total Content</div>
                </div>
            </div>
        </div>

        <div class="content-section" id="add">
            <div class="success-message" id="successMessage"></div>
            <div class="error-message" id="errorMessage"></div>

            <!-- Test Buttons Section -->
            <div class="test-buttons">
                <button class="btn" onclick="fillTestData('movies')" style="background: #ff9800;">
                    üé¨ Test Movie
                </button>
                <button class="btn" onclick="fillTestData('anime')" style="background: #9c27b0;">
                    üéå Test Anime
                </button>
                <button class="btn" onclick="fillTestData('webseries')" style="background: #2196f3;">
                    üì∫ Test Web Series
                </button>
            </div>

            <div class="form-group">
                <label>Content Type *</label>
                <select id="contentType" onchange="toggleContentType()">
                    <option value="movies">Movie</option>
                    <option value="anime">Anime</option>
                    <option value="webseries">Web Series</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Title *</label>
                <input type="text" id="title" placeholder="Enter title" required>
            </div>
            
            <div class="form-group">
                <label>Image URL *</label>
                <input type="text" id="imageUrl" placeholder="Paste image URL here" required oninput="updateImagePreview()">
                <img id="imagePreview" class="image-preview" alt="Preview">
            </div>
            
            <div class="form-group">
                <label>Description</label>
                <textarea id="description" placeholder="Enter description"></textarea>
            </div>

            <!-- Category System -->
            <div class="form-group">
                <label>Category (Select up to 10)</label>
                <div class="checkbox-group" id="categoryCheckboxGroup">
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-action" value="Action" onchange="updateCategories()">
                        <label for="cat-action">Action</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-adventure" value="Adventure" onchange="updateCategories()">
                        <label for="cat-adventure">Adventure</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-comedy" value="Comedy" onchange="updateCategories()">
                        <label for="cat-comedy">Comedy</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-crime" value="Crime" onchange="updateCategories()">
                        <label for="cat-crime">Crime</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-drama" value="Drama" onchange="updateCategories()">
                        <label for="cat-drama">Drama</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-fantasy" value="Fantasy" onchange="updateCategories()">
                        <label for="cat-fantasy">Fantasy</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-horror" value="Horror" onchange="updateCategories()">
                        <label for="cat-horror">Horror</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-mystery" value="Mystery" onchange="updateCategories()">
                        <label for="cat-mystery">Mystery</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-romance" value="Romance" onchange="updateCategories()">
                        <label for="cat-romance">Romance</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-scifi" value="Sci-Fi" onchange="updateCategories()">
                        <label for="cat-scifi">Sci-Fi</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cat-thriller" value="Thriller" onchange="updateCategories()">
                        <label for="cat-thriller">Thriller</label>
                    </div>
                </div>
                <div class="category-tags" id="categoryTags">
                    <small style="color: #999;">No categories selected</small>
                </div>
            </div>

            <div class="form-group">
                <label>Language (Maximum 5) *</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="lang-english" value="English" onchange="checkLanguageLimit()">
                        <label for="lang-english">English</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="lang-hindi" value="Hindi" onchange="checkLanguageLimit()">
                        <label for="lang-hindi">Hindi</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="lang-japanese" value="Japanese" onchange="checkLanguageLimit()">
                        <label for="lang-japanese">Japanese</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="lang-korean" value="Korean" onchange="checkLanguageLimit()">
                        <label for="lang-korean">Korean</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="lang-spanish" value="Spanish" onchange="checkLanguageLimit()">
                        <label for="lang-spanish">Spanish</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="lang-telegu" value="Telegu" onchange="checkLanguageLimit()">
                        <label for="lang-telegu">Telegu</label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Year</label>
                <input type="number" id="year" placeholder="2024">
            </div>
            
            <div class="form-group">
                <label>Rating</label>
                <input type="text" id="rating" placeholder="8.5">
            </div>
            
            <div class="form-group">
                <label>Duration</label>
                <input type="text" id="duration" placeholder="2h 30m">
            </div>
            
            <div class="form-group">
                <label>Video URL (Streaming)</label>
                <input type="text" id="videoUrl" placeholder="Enter video streaming URL">
            </div>

            <!-- Movie Download Links -->
            <div id="movieDownloadLinks" style="display: block;">
                <h3 style="color: #667eea; margin: 20px 0;">Movie Download Links</h3>
                <div class="quality-inputs">
                    <div class="quality-input">
                        <label>480p Download Link</label>
                        <input type="text" id="download480p" placeholder="https://example.com/movie-480p.mp4">
                    </div>
                    <div class="quality-input">
                        <label>720p Download Link</label>
                        <input type="text" id="download720p" placeholder="https://example.com/movie-720p.mp4">
                    </div>
                    <div class="quality-input">
                        <label>1080p Download Link</label>
                        <input type="text" id="download1080p" placeholder="https://example.com/movie-1080p.mp4">
                    </div>
                    <div class="quality-input">
                        <label>4K Download Link</label>
                        <input type="text" id="download4k" placeholder="https://example.com/movie-4k.mp4">
                    </div>
                </div>
            </div>

            <!-- Series Options -->
            <div id="seriesOptions" style="display: none;">
                <h3 style="color: #667eea; margin: 20px 0;">Series/Anime Information</h3>
                <div class="form-group">
                    <label>Number of Seasons</label>
                    <input type="number" id="seasons" placeholder="1" value="1" min="1">
                </div>
                <div class="form-group">
                    <label>Total Episodes</label>
                    <input type="number" id="totalEpisodes" placeholder="12" min="1">
                </div>

                <h4 style="color: #667eea; margin: 20px 0;">Add Episodes with Download Links</h4>
                <p style="color: #999; margin-bottom: 15px; font-size: 14px;">Add individual episodes with their download links.</p>

                <div id="episodesContainer"></div>
                <button class="add-episode-btn" type="button" onclick="addEpisode()">+ Add Episode</button>

                <!-- Series ZIP Download Links -->
                <div class="zip-download-section" id="seriesZipSection">
                    <h4 style="color: #ff9800; margin-bottom: 15px;">üéÅ Complete Series ZIP Downloads (Optional)</h4>
                    <div class="zip-note">
                        üí° Provide ZIP file links for complete series downloads. Users can download entire seasons in ZIP format.
                    </div>

                    <div class="zip-quality-selector">
                        <button class="zip-quality-btn active" data-quality="season" onclick="showZipOption('season')">üåø Season Wise</button>
                        <button class="zip-quality-btn" data-quality="complete" onclick="showZipOption('complete')">üå≥ Complete Series</button>
                    </div>

                    <!-- Season Wise ZIP -->
                    <div class="zip-option active" id="zipSeasonOption">
                        <h5 style="color: #4CAF50; margin: 15px 0;">Season Wise ZIP Links</h5>
                        <div id="seasonZipContainer">
                            <div class="quality-inputs">
                                <div class="quality-input">
                                    <label>üì¶ Season 1 ZIP (480p)</label>
                                    <div class="zip-size-input">
                                        <input type="text" id="season1Zip480p" placeholder="https://example.com/season1-480p.zip">
                                        <input type="text" id="season1Zip480pSize" placeholder="Size" style="width: 100px;">
                                        <select id="season1Zip480pSizeUnit">
                                            <option value="GB">GB</option>
                                            <option value="MB">MB</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="quality-input">
                                    <label>üì¶ Season 1 ZIP (720p)</label>
                                    <div class="zip-size-input">
                                        <input type="text" id="season1Zip720p" placeholder="https://example.com/season1-720p.zip">
                                        <input type="text" id="season1Zip720pSize" placeholder="Size" style="width: 100px;">
                                        <select id="season1Zip720pSizeUnit">
                                            <option value="GB">GB</option>
                                            <option value="MB">MB</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button class="add-episode-btn" type="button" onclick="addSeasonZip()" style="background: #ff9800;">+ Add More Seasons</button>
                    </div>

                    <!-- Complete Series ZIP -->
                    <div class="zip-option" id="zipCompleteOption">
                        <h5 style="color: #4CAF50; margin: 15px 0;">Complete Series ZIP Links</h5>
                        <div class="quality-inputs">
                            <div class="quality-input">
                                <label>üì¶ Complete Series (480p)</label>
                                <div class="zip-size-input">
                                    <input type="text" id="completeZip480p" placeholder="https://example.com/complete-480p.zip">
                                    <input type="text" id="completeZip480pSize" placeholder="Size" style="width: 100px;">
                                    <select id="completeZip480pSizeUnit">
                                        <option value="GB">GB</option>
                                        <option value="MB">MB</option>
                                    </select>
                                </div>
                            </div>
                            <div class="quality-input">
                                <label>üì¶ Complete Series (720p)</label>
                                <div class="zip-size-input">
                                    <input type="text" id="completeZip720p" placeholder="https://example.com/complete-720p.zip">
                                    <input type="text" id="completeZip720pSize" placeholder="Size" style="width: 100px;">
                                    <select id="completeZip720pSizeUnit">
                                        <option value="GB">GB</option>
                                        <option value="MB">MB</option>
                                    </select>
                                </div>
                            </div>
                            <div class="quality-input">
                                <label>üì¶ Complete Series (1080p)</label>
                                <div class="zip-size-input">
                                    <input type="text" id="completeZip1080p" placeholder="https://example.com/complete-1080p.zip">
                                    <input type="text" id="completeZip1080pSize" placeholder="Size" style="width: 100px;">
                                    <select id="completeZip1080pSizeUnit">
                                        <option value="GB">GB</option>
                                        <option value="MB">MB</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group" style="margin-top: 30px;">
                <label>
                    <input type="checkbox" id="featured" style="width: auto; margin-right: 10px;"> Featured Content
                </label>
            </div>

            <!-- Add Content Container with spacing -->
            <div class="add-content-container">
                <button class="btn btn-primary" id="addContentBtn" onclick="addContent()">
                    ‚ûï Add Content
                </button>
            </div>
        </div>

        <div class="content-section" id="manage">
            <div class="action-bar">
                <select id="manageType" onchange="loadContent()" class="content-type-filter">
                    <option value="movies">Movies</option>
                    <option value="anime">Anime</option>
                    <option value="webseries">Web Series</option>
                </select>
                <input type="text" class="search-box" id="searchBox" placeholder="üîç Search by title, category..." oninput="filterContent()">
                <button class="refresh-btn" onclick="loadContent()">
                    üîÑ Refresh
                </button>
            </div>
            <div id="contentList" class="content-grid">
                <div class="loading">Loading content...</div>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div id="editForm">
                <!-- Edit form will be loaded dynamically -->
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'https://rdbhub4u.onrender.com/api';
        let allContent = [];
        let selectedCategories = [];
        let episodeCounter = 0;
        let isServerOnline = false;
        let seasonZipCounter = 1;
        let currentPage = 1;
        const itemsPerPage = 12;

        // ==================== INITIALIZATION ====================
        window.addEventListener('DOMContentLoaded', async function() {
            await checkServerConnection();
            loadStats();
            initCategorySystem();
            loadContent();
            
            // Set up event listeners
            setupEventListeners();
            
            // Initialize form
            toggleContentType();
        });

        // ==================== SERVER CONNECTION ====================
        async function checkServerConnection() {
            const statusEl = document.getElementById('connectionStatus');
            try {
                const response = await fetch(`${API_URL}/stats`, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json'
                    },
                    timeout: 5000
                });

                if (response.ok) {
                    isServerOnline = true;
                    statusEl.textContent = 'üü¢ Server Online';
                    statusEl.className = 'connection-status online';
                    return true;
                } else {
                    throw new Error('Server response not OK');
                }
            } catch (error) {
                isServerOnline = false;
                statusEl.textContent = 'üî¥ Server Offline';
                statusEl.className = 'connection-status offline';
                console.error('Server connection error:', error);
                return false;
            }
        }

        // ==================== LOAD STATS ====================
        async function loadStats() {
            try {
                const response = await fetch(`${API_URL}/stats`, {
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch stats');
                }

                const stats = await response.json();
                document.getElementById('moviesCount').textContent = stats.movies || stats.moviesCount || 0;
                document.getElementById('animeCount').textContent = stats.anime || stats.animeCount || 0;
                document.getElementById('webseriesCount').textContent = stats.webseries || stats.webseriesCount || 0;
                document.getElementById('totalCount').textContent = stats.totalContent || stats.total || 0;

            } catch (error) {
                console.error('Error loading stats:', error);
                document.getElementById('moviesCount').textContent = '‚Äî';
                document.getElementById('animeCount').textContent = '‚Äî';
                document.getElementById('webseriesCount').textContent = '‚Äî';
                document.getElementById('totalCount').textContent = '‚Äî';
            }
        }

        // ==================== CATEGORY SYSTEM ====================
        function initCategorySystem() {
            updateCategories();
        }

        function updateCategories() {
            const checkboxes = document.querySelectorAll('#categoryCheckboxGroup input[type="checkbox"]');
            selectedCategories = [];
            
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    selectedCategories.push(checkbox.value);
                }
            });
            
            // Limit to 10 categories
            if (selectedCategories.length > 10) {
                const lastChecked = selectedCategories.pop();
                const checkbox = document.querySelector(`#categoryCheckboxGroup input[value="${lastChecked}"]`);
                if (checkbox) {
                    checkbox.checked = false;
                }
                showMessage('Maximum 10 categories allowed', 'error');
            }
            
            updateCategoryTags();
        }

        function updateCategoryTags() {
            const container = document.getElementById('categoryTags');
            if (selectedCategories.length === 0) {
                container.innerHTML = '<small style="color: #999;">No categories selected</small>';
                return;
            }
            container.innerHTML = selectedCategories.map(cat => `
                <div class="category-tag">
                    ${cat}
                    <button type="button" onclick="removeCategory('${cat}')">&times;</button>
                </div>
            `).join('');
        }

        function removeCategory(category) {
            selectedCategories = selectedCategories.filter(c => c !== category);
            const checkbox = document.querySelector(`#categoryCheckboxGroup input[value="${category}"]`);
            if (checkbox) {
                checkbox.checked = false;
            }
            updateCategoryTags();
        }

        // ==================== LANGUAGE LIMIT ====================
        function checkLanguageLimit() {
            const checkedBoxes = document.querySelectorAll('input[type="checkbox"][id^="lang-"]:checked');
            if (checkedBoxes.length > 5) {
                event.target.checked = false;
                showMessage('Maximum 5 languages allowed', 'error');
            }
        }

        // ==================== IMAGE PREVIEW ====================
        function updateImagePreview() {
            const preview = document.getElementById('imagePreview');
            const url = document.getElementById('imageUrl').value.trim();
            if (url) {
                preview.src = url;
                preview.style.display = 'block';
                preview.onerror = function() {
                    preview.style.display = 'none';
                };
            } else {
                preview.style.display = 'none';
            }
        }

        // ==================== CONTENT TYPE TOGGLE ====================
        function toggleContentType() {
            const type = document.getElementById('contentType').value;
            const movieLinks = document.getElementById('movieDownloadLinks');
            const seriesOptions = document.getElementById('seriesOptions');
            
            if (type === 'movies') {
                movieLinks.style.display = 'block';
                seriesOptions.style.display = 'none';
            } else {
                movieLinks.style.display = 'none';
                seriesOptions.style.display = 'block';
                // Initialize episodes if empty
                if (document.getElementById('episodesContainer').children.length === 0) {
                    addEpisode();
                }
            }
        }

        // ==================== EPISODE SYSTEM ====================
        function addEpisode() {
            episodeCounter++;
            const episodesContainer = document.getElementById('episodesContainer');
            
            const episodeHTML = `
                <div class="episode-section" id="episode${episodeCounter}">
                    <div class="episode-header">
                        <h4 style="color: #667eea;">Episode ${episodeCounter}</h4>
                        <button class="remove-episode-btn" onclick="removeEpisode(${episodeCounter})">
                            ‚úï Remove
                        </button>
                    </div>
                    <div class="form-group">
                        <label>Episode Number</label>
                        <input type="number" id="ep${episodeCounter}-number" value="${episodeCounter}" min="1">
                    </div>
                    <div class="form-group">
                        <label>Episode Title</label>
                        <input type="text" id="ep${episodeCounter}-title" placeholder="Episode ${episodeCounter} Title">
                    </div>
                    <div class="form-group">
                        <label>Download Links</label>
                        <div class="quality-inputs">
                            <div class="quality-input">
                                <label>480p</label>
                                <input type="text" id="ep${episodeCounter}-480p" placeholder="https://example.com/ep${episodeCounter}-480p.mp4">
                            </div>
                            <div class="quality-input">
                                <label>720p</label>
                                <input type="text" id="ep${episodeCounter}-720p" placeholder="https://example.com/ep${episodeCounter}-720p.mp4">
                            </div>
                            <div class="quality-input">
                                <label>1080p</label>
                                <input type="text" id="ep${episodeCounter}-1080p" placeholder="https://example.com/ep${episodeCounter}-1080p.mp4">
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            episodesContainer.insertAdjacentHTML('beforeend', episodeHTML);
        }

        function removeEpisode(episodeId) {
            const episodeDiv = document.getElementById(`episode${episodeId}`);
            if (episodeDiv) {
                if (confirm('Are you sure you want to remove this episode?')) {
                    episodeDiv.remove();
                    // Recalculate episode numbers
                    const episodes = document.querySelectorAll('.episode-section');
                    episodes.forEach((ep, index) => {
                        const epNum = index + 1;
                        ep.querySelector('h4').textContent = `Episode ${epNum}`;
                        const numberInput = ep.querySelector('input[type="number"]');
                        const titleInput = ep.querySelector('input[type="text"][placeholder*="Title"]');
                        if (numberInput) numberInput.value = epNum;
                        if (titleInput) titleInput.placeholder = `Episode ${epNum} Title`;
                        
                        // Update IDs
                        const qualityInputs = ep.querySelectorAll('.quality-input input');
                        qualityInputs.forEach(input => {
                            input.id = input.id.replace(/ep\d+/, `ep${epNum}`);
                        });
                    });
                    episodeCounter = episodes.length;
                }
            }
        }

        // ==================== ZIP DOWNLOADS ====================
        function showZipOption(option) {
            document.querySelectorAll('.zip-option').forEach(opt => opt.classList.remove('active'));
            document.querySelectorAll('.zip-quality-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`zip${option.charAt(0).toUpperCase() + option.slice(1)}Option`).classList.add('active');
            event.target.classList.add('active');
        }

        function addSeasonZip() {
            seasonZipCounter++;
            const container = document.getElementById('seasonZipContainer');
            
            const seasonHTML = `
                <div class="quality-inputs">
                    <div class="quality-input">
                        <label>üì¶ Season ${seasonZipCounter} ZIP (480p)</label>
                        <div class="zip-size-input">
                            <input type="text" id="season${seasonZipCounter}Zip480p" placeholder="https://example.com/season${seasonZipCounter}-480p.zip">
                            <input type="text" id="season${seasonZipCounter}Zip480pSize" placeholder="Size" style="width: 100px;">
                            <select id="season${seasonZipCounter}Zip480pSizeUnit">
                                <option value="GB">GB</option>
                                <option value="MB">MB</option>
                            </select>
                        </div>
                    </div>
                    <div class="quality-input">
                        <label>üì¶ Season ${seasonZipCounter} ZIP (720p)</label>
                        <div class="zip-size-input">
                            <input type="text" id="season${seasonZipCounter}Zip720p" placeholder="https://example.com/season${seasonZipCounter}-720p.zip">
                            <input type="text" id="season${seasonZipCounter}Zip720pSize" placeholder="Size" style="width: 100px;">
                            <select id="season${seasonZipCounter}Zip720pSizeUnit">
                                <option value="GB">GB</option>
                                <option value="MB">MB</option>
                            </select>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', seasonHTML);
        }

        // ==================== ADD CONTENT ====================
        async function addContent() {
            // Validate required fields
            const contentType = document.getElementById('contentType').value;
            const title = document.getElementById('title').value.trim();
            const imageUrl = document.getElementById('imageUrl').value.trim();
            
            if (!title || !imageUrl) {
                showMessage('Title and Image URL are required!', 'error');
                return;
            }
            
            // Collect selected languages
            const languages = [];
            document.querySelectorAll('input[type="checkbox"][id^="lang-"]:checked').forEach(cb => {
                languages.push(cb.value);
            });
            
            if (languages.length === 0) {
                showMessage('Please select at least one language', 'error');
                return;
            }
            
            // Prepare data object
            const data = {
                title: title,
                image: imageUrl,
                description: document.getElementById('description').value.trim() || '',
                category: selectedCategories.join(', ') || '',
                language: languages,
                year: document.getElementById('year').value ? parseInt(document.getElementById('year').value) : null,
                rating: document.getElementById('rating').value.trim() || '',
                duration: document.getElementById('duration').value.trim() || '',
                videoUrl: document.getElementById('videoUrl').value.trim() || '',
                featured: document.getElementById('featured').checked || false
            };
            
            // Add download links based on content type
            if (contentType === 'movies') {
                const downloadLinks = {};
                const qualities = ['480p', '720p', '1080p', '4k'];
                
                qualities.forEach(quality => {
                    const link = document.getElementById(`download${quality}`).value.trim();
                    if (link) {
                        downloadLinks[quality] = link;
                    }
                });
                
                if (Object.keys(downloadLinks).length > 0) {
                    data.download = downloadLinks;
                    data.quality = Object.keys(downloadLinks);
                }
            } else {
                // Series/Anime data
                data.seasons = parseInt(document.getElementById('seasons').value) || 1;
                data.totalEpisodes = parseInt(document.getElementById('totalEpisodes').value) || 1;
                
                // Collect episodes
                const episodes = [];
                const episodeElements = document.querySelectorAll('.episode-section');
                
                episodeElements.forEach((ep, index) => {
                    const episodeNumber = parseInt(ep.querySelector('input[type="number"]').value) || (index + 1);
                    const episodeTitle = ep.querySelector('input[type="text"][placeholder*="Title"]').value.trim() || `Episode ${episodeNumber}`;
                    const episodeDownloads = {};
                    
                    // Get download links for this episode
                    const qualities = ['480p', '720p', '1080p'];
                    qualities.forEach(quality => {
                        const link = document.getElementById(`ep${episodeNumber}-${quality}`)?.value.trim();
                        if (link) {
                            episodeDownloads[quality] = link;
                        }
                    });
                    
                    if (Object.keys(episodeDownloads).length > 0) {
                        episodes.push({
                            episodeNumber: episodeNumber,
                            title: episodeTitle,
                            download: episodeDownloads
                        });
                    }
                });
                
                if (episodes.length > 0) {
                    data.episodes = episodes;
                    data.quality = [...new Set(episodes.flatMap(ep => Object.keys(ep.download)))];
                }
                
                // Collect ZIP download data
                const zipData = {
                    seasonWise: {},
                    completeSeries: {}
                };
                
                // Get season-wise ZIP links
                for (let i = 1; i <= seasonZipCounter; i++) {
                    const seasonKey = `season${i}`;
                    zipData.seasonWise[seasonKey] = {};
                    
                    ['480p', '720p'].forEach(quality => {
                        const link = document.getElementById(`${seasonKey}Zip${quality}`)?.value.trim();
                        const size = document.getElementById(`${seasonKey}Zip${quality}Size`)?.value.trim();
                        const unit = document.getElementById(`${seasonKey}Zip${quality}SizeUnit`)?.value;
                        
                        if (link) {
                            zipData.seasonWise[seasonKey][quality] = {
                                link: link,
                                size: size && unit ? `${size} ${unit}` : undefined
                            };
                        }
                    });
                }
                
                // Get complete series ZIP links
                ['480p', '720p', '1080p'].forEach(quality => {
                    const link = document.getElementById(`completeZip${quality}`)?.value.trim();
                    const size = document.getElementById(`completeZip${quality}Size`)?.value.trim();
                    const unit = document.getElementById(`completeZip${quality}SizeUnit`)?.value;
                    
                    if (link) {
                        zipData.completeSeries[quality] = {
                            link: link,
                            size: size && unit ? `${size} ${unit}` : undefined
                        };
                    }
                });
                
                // Add ZIP data if exists
                if (Object.keys(zipData.seasonWise).length > 0 || Object.keys(zipData.completeSeries).length > 0) {
                    data.zipDownload = zipData;
                }
            }
            
            // Show loading state
            const addBtn = document.getElementById('addContentBtn');
            const originalText = addBtn.innerHTML;
            addBtn.innerHTML = '‚è≥ Adding...';
            addBtn.disabled = true;
            
            try {
                console.log('Sending data to API:', data);
                console.log('API URL:', `${API_URL}/${contentType}`);
                
                const response = await fetch(`${API_URL}/${contentType}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                console.log('Response status:', response.status);
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('Success response:', result);
                    
                    showMessage('‚úÖ Content added successfully!', 'success');
                    
                    // Reset form
                    resetForm();
                    
                    // Refresh stats
                    loadStats();
                    
                    // Switch to manage tab
                    document.querySelector('.tab-btn[data-tab="manage"]').click();
                    document.getElementById('manageType').value = contentType;
                    setTimeout(() => loadContent(), 500);
                    
                } else {
                    const errorData = await response.json().catch(() => ({ error: `HTTP ${response.status}` }));
                    throw new Error(errorData.error || errorData.message || 'Failed to add content');
                }
                
            } catch (error) {
                console.error('Error adding content:', error);
                showMessage(`‚ùå Error: ${error.message}`, 'error');
            } finally {
                addBtn.innerHTML = originalText;
                addBtn.disabled = false;
            }
        }

        // ==================== RESET FORM ====================
        function resetForm() {
            // Clear all inputs
            document.getElementById('title').value = '';
            document.getElementById('imageUrl').value = '';
            document.getElementById('description').value = '';
            document.getElementById('year').value = '';
            document.getElementById('rating').value = '';
            document.getElementById('duration').value = '';
            document.getElementById('videoUrl').value = '';
            document.getElementById('featured').checked = false;
            
            // Clear categories
            selectedCategories = [];
            document.querySelectorAll('#categoryCheckboxGroup input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
            });
            updateCategoryTags();
            
            // Clear languages
            document.querySelectorAll('input[type="checkbox"][id^="lang-"]').forEach(cb => {
                cb.checked = false;
            });
            
            // Clear download links
            document.getElementById('download480p').value = '';
            document.getElementById('download720p').value = '';
            document.getElementById('download1080p').value = '';
            document.getElementById('download4k').value = '';
            
            // Clear episodes
            document.getElementById('episodesContainer').innerHTML = '';
            episodeCounter = 0;
            
            // Clear ZIP inputs
            document.getElementById('season1Zip480p').value = '';
            document.getElementById('season1Zip480pSize').value = '';
            document.getElementById('season1Zip720p').value = '';
            document.getElementById('season1Zip720pSize').value = '';
            document.getElementById('completeZip480p').value = '';
            document.getElementById('completeZip480pSize').value = '';
            document.getElementById('completeZip720p').value = '';
            document.getElementById('completeZip720pSize').value = '';
            document.getElementById('completeZip1080p').value = '';
            document.getElementById('completeZip1080pSize').value = '';
            seasonZipCounter = 1;
            
            // Clear image preview
            document.getElementById('imagePreview').style.display = 'none';
            
            // Reset to movies type
            document.getElementById('contentType').value = 'movies';
            toggleContentType();
        }

        // ==================== LOAD CONTENT (FIXED FOR ANIME & WEBSERIES) ====================
        async function loadContent() {
            const type = document.getElementById('manageType').value;
            const contentList = document.getElementById('contentList');
            contentList.innerHTML = '<div class="loading">‚è≥ Loading content...</div>';

            try {
                console.log(`Loading ${type} from: ${API_URL}/${type}`);
                
                const response = await fetch(`${API_URL}/${type}`, {
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status} - Failed to fetch ${type}`);
                }

                const result = await response.json();
                console.log('API Response for', type, ':', result);
                
                // Extract content array from response
                let contentArray = [];

                if (result.success) {
                    // Try different response structures
                    if (result[type] && Array.isArray(result[type])) {
                        contentArray = result[type];
                    } else if (result.data && Array.isArray(result.data)) {
                        contentArray = result.data;
                    } else if (result.content && Array.isArray(result.content)) {
                        contentArray = result.content;
                    } else if (result.movies && Array.isArray(result.movies)) {
                        contentArray = result.movies;
                    } else if (result.anime && Array.isArray(result.anime)) {
                        contentArray = result.anime;
                    } else if (result.webseries && Array.isArray(result.webseries)) {
                        contentArray = result.webseries;
                    } else {
                        // Look for any array in the response
                        for (const key in result) {
                            if (Array.isArray(result[key]) && key !== 'success' && key !== 'message' && key !== 'count') {
                                contentArray = result[key];
                                console.log(`Found array in key: ${key}`);
                                break;
                            }
                        }
                    }
                } 
                // Direct array response
                else if (Array.isArray(result)) {
                    contentArray = result;
                }
                // Try to find array in nested response
                else {
                    for (const key in result) {
                        if (Array.isArray(result[key])) {
                            contentArray = result[key];
                            console.log(`Found array in key: ${key}`);
                            break;
                        }
                    }
                }

                console.log(`Extracted ${contentArray.length} items for ${type}`);
                
                if (!contentArray || !Array.isArray(contentArray)) {
                    contentArray = [];
                    console.warn(`No valid array found for ${type}, using empty array`);
                }
                
                allContent = contentArray;
                currentPage = 1;

                if (allContent.length === 0) {
                    contentList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">üì¶</div>
                            <div>No ${type} found</div>
                            <div style="margin-top: 10px; font-size: 14px; color: #666;">
                                Add your first ${type} using the "Add Content" tab.
                            </div>
                        </div>
                    `;
                    return;
                }

                displayContent(allContent.slice(0, itemsPerPage));
                setupPagination();

            } catch (error) {
                console.error(`Error loading ${type}:`, error);
                contentList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚ö†</div>
                        <div>Error loading ${type}</div>
                        <div style="font-size: 12px; margin-top: 10px; color: #666; background: #252936; padding: 10px; border-radius: 6px;">
                            ${error.message}<br>
                            <small>URL: ${API_URL}/${type}</small>
                        </div>
                        <div style="margin-top: 15px;">
                            <button class="btn" onclick="loadContent()" style="background: #667eea; padding: 8px 16px;">
                                üîÑ Try Again
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        // ==================== DISPLAY CONTENT ====================
        function displayContent(content) {
            const contentList = document.getElementById('contentList');

            if (!content || content.length === 0) {
                contentList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <div>No content found</div>
                    </div>
                `;
                return;
            }

            contentList.innerHTML = content.map(item => {
                // Safely get data with fallbacks
                const itemId = item._id || item.id || '';
                const itemTitle = item.title || 'Untitled';
                const itemImage = item.image || 'https://via.placeholder.com/200x280?text=No+Image';
                const itemYear = item.year || 'N/A';
                const itemRating = item.rating || 'N/A';
                const itemCategory = item.category || '';
                const itemFeatured = item.featured || false;
                
                // Check if item has zipDownload
                const hasZip = item.zipDownload && (
                    (item.zipDownload.seasonWise && Object.keys(item.zipDownload.seasonWise).length > 0) ||
                    (item.zipDownload.completeSeries && Object.keys(item.zipDownload.completeSeries).length > 0)
                );

                // Get quality badges
                let qualities = [];
                if (item.quality && Array.isArray(item.quality)) {
                    qualities = item.quality;
                } else if (item.download && typeof item.download === 'object') {
                    qualities = Object.keys(item.download);
                }
                
                const qualityBadges = qualities.slice(0, 3).map(q => 
                    `<span class="quality-badge">${q}</span>`
                ).join('');

                // Status badge
                const statusBadge = itemFeatured ? 
                    '<span class="status-badge status-featured">‚≠ê Featured</span>' : 
                    '<span class="status-badge status-regular">Regular</span>';

                return `
                <div class="content-card" data-id="${itemId}">
                    <img src="${itemImage}" 
                         alt="${itemTitle}" 
                         class="content-img"
                         onerror="this.src='https://via.placeholder.com/200x280?text=No+Image'">
                    <div class="content-info">
                        <div class="content-title" title="${itemTitle}">${itemTitle}</div>
                        <div class="content-meta">
                            <span>${itemYear}</span>
                            <span>‚≠ê ${itemRating}</span>
                        </div>
                        <div style="margin-bottom: 8px;">
                            ${qualityBadges}
                            ${qualities.length > 3 ? `<span style="color: #999; font-size: 12px;">+${qualities.length - 3} more</span>` : ''}
                        </div>
                        <div style="margin-bottom: 8px;">
                            ${statusBadge}
                            ${hasZip ? '<span class="quality-badge" style="background: #ff9800;">üì¶ ZIP</span>' : ''}
                        </div>
                        <div class="content-actions">
                            <button class="btn btn-small btn-edit" 
                                    onclick="openEditModal('${itemId}', '${document.getElementById('manageType').value}')">
                                ‚úè Edit
                            </button>
                            <button class="btn btn-small btn-delete" 
                                    onclick="deleteContent('${itemId}', '${document.getElementById('manageType').value}')">
                                üóë Delete
                            </button>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        // ==================== PAGINATION ====================
        function setupPagination() {
            const totalPages = Math.ceil(allContent.length / itemsPerPage);
            
            if (totalPages <= 1) {
                return;
            }

            const contentList = document.getElementById('contentList');
            const paginationHTML = `
                <div class="pagination">
                    <button class="pagination-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                        ‚Üê Previous
                    </button>
                    <span class="page-info">Page ${currentPage} of ${totalPages}</span>
                    <button class="pagination-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                        Next ‚Üí
                    </button>
                </div>
            `;

            contentList.insertAdjacentHTML('beforeend', paginationHTML);
        }

        function changePage(page) {
            if (page < 1 || page > Math.ceil(allContent.length / itemsPerPage)) return;
            
            currentPage = page;
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageContent = allContent.slice(startIndex, endIndex);
            
            displayContent(pageContent);
            setupPagination();
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ==================== SEARCH/FILTER ====================
        function filterContent() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase().trim();
            
            if (!searchTerm) {
                currentPage = 1;
                displayContent(allContent.slice(0, itemsPerPage));
                setupPagination();
                return;
            }
            
            const filtered = allContent.filter(item => {
                if (!item) return false;
                
                if (item.title && item.title.toLowerCase().includes(searchTerm)) return true;
                if (item.category && item.category.toLowerCase().includes(searchTerm)) return true;
                if (item.description && item.description.toLowerCase().includes(searchTerm)) return true;
                if (item.year && item.year.toString().includes(searchTerm)) return true;
                
                return false;
            });
            
            if (filtered.length === 0) {
                document.getElementById('contentList').innerHTML = `
                    <div class="no-results" style="grid-column: 1 / -1;">
                        <div style="font-size: 48px; margin-bottom: 20px;">üîç</div>
                        <div>No results found for "${searchTerm}"</div>
                        <button class="btn" onclick="document.getElementById('searchBox').value = ''; filterContent()" 
                                style="background: #667eea; padding: 8px 16px; margin-top: 15px;">
                            Clear Search
                        </button>
                    </div>
                `;
            } else {
                currentPage = 1;
                displayContent(filtered.slice(0, itemsPerPage));
                setupPagination();
            }
        }

        // ==================== EDIT MODAL ====================
        async function openEditModal(id, type) {
            try {
                document.getElementById('editForm').innerHTML = `
                    <div style="text-align: center; padding: 60px 20px;">
                        <div class="spinner" style="width: 50px; height: 50px; margin: 0 auto 20px;"></div>
                        <h3 style="color: #667eea; margin-bottom: 10px;">Loading Content Details</h3>
                        <p style="color: #999;">Please wait...</p>
                    </div>
                `;
                document.getElementById('editModal').classList.add('active');

                console.log(`Fetching ${type} with ID: ${id} from ${API_URL}/${type}/${id}`);
                
                const response = await fetch(`${API_URL}/${type}/${id}`, {
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status} - Failed to fetch item`);
                }

                const result = await response.json();
                console.log('Edit modal response:', result);
                
                let item = null;
                if (result.success) {
                    item = result.content || result.data || result.movie || result.anime || result.webseries || result;
                } else if (result.data) {
                    item = result.data;
                } else {
                    item = result;
                }

                if (!item) {
                    throw new Error('Could not find content data in response');
                }

                createEditForm(item, type, id);

            } catch (error) {
                console.error('Error opening edit modal:', error);
                document.getElementById('editForm').innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: #f44336;">
                        <div style="font-size: 48px; margin-bottom: 20px;">‚ùå</div>
                        <h3>Error Loading Content</h3>
                        <p style="margin: 15px 0; color: #999; background: #252936; padding: 15px; border-radius: 8px;">
                            ${error.message}
                        </p>
                        <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
                            <button class="btn" onclick="openEditModal('${id}', '${type}')" 
                                    style="background: #667eea; padding: 10px 20px;">
                                üîÑ Try Again
                            </button>
                            <button class="btn" onclick="closeEditModal()" 
                                    style="background: #666; padding: 10px 20px;">
                                Cancel
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        function createEditForm(item, type, id) {
            // Get languages safely
            let languages = '';
            if (Array.isArray(item.language)) {
                languages = item.language.join(', ');
            } else if (item.language) {
                languages = item.language;
            }
            
            // Get categories
            const category = item.category || '';
            
            // Simple edit form
            const editFormHTML = `
                <div class="modal-header">
                    <h2>Edit ${type.charAt(0).toUpperCase() + type.slice(1)}</h2>
                    <button class="close-btn" onclick="closeEditModal()">&times;</button>
                </div>
                
                <input type="hidden" id="editId" value="${id}">
                <input type="hidden" id="editType" value="${type}">

                <div class="form-group">
                    <label>Title *</label>
                    <input type="text" id="editTitle" value="${item.title || ''}" required>
                </div>

                <div class="form-group">
                    <label>Image URL *</label>
                    <input type="text" id="editImageUrl" value="${item.image || ''}" required>
                    <div style="margin-top: 10px;">
                        <img src="${item.image}" alt="Preview" 
                             style="max-width: 200px; max-height: 150px; border-radius: 8px; border: 2px solid #333;"
                             onerror="this.style.display='none'">
                    </div>
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <textarea id="editDescription" rows="4">${item.description || ''}</textarea>
                </div>

                <div class="form-group">
                    <label>Category</label>
                    <input type="text" id="editCategory" value="${category}" 
                           placeholder="Action, Drama, Comedy">
                </div>

                <div class="form-group">
                    <label>Languages</label>
                    <input type="text" id="editLanguage" value="${languages}" 
                           placeholder="English, Hindi, Japanese">
                </div>

                <div class="form-group">
                    <label>Year</label>
                    <input type="number" id="editYear" value="${item.year || ''}" placeholder="2024">
                </div>

                <div class="form-group">
                    <label>Rating</label>
                    <input type="text" id="editRating" value="${item.rating || ''}" placeholder="8.5">
                </div>

                <div class="form-group">
                    <label>Duration</label>
                    <input type="text" id="editDuration" value="${item.duration || ''}" placeholder="2h 30m">
                </div>

                <div class="form-group">
                    <label>Video URL (Streaming)</label>
                    <input type="text" id="editVideoUrl" value="${item.videoUrl || ''}" 
                           placeholder="https://example.com/stream.mp4">
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="editFeatured" ${item.featured ? 'checked' : ''} style="width: auto;">
                        <span>‚≠ê Mark as Featured Content</span>
                    </label>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 30px; padding-top: 20px; border-top: 2px solid #333;">
                    <button class="btn btn-primary" onclick="updateContentSimple()" style="flex: 1;">
                        üíæ Save Changes
                    </button>
                    <button class="btn" onclick="closeEditModal()" 
                            style="background: #666; color: white; flex: 0.5;">
                        Cancel
                    </button>
                </div>
            `;

            document.getElementById('editForm').innerHTML = editFormHTML;
        }

        async function updateContentSimple() {
            const id = document.getElementById('editId').value;
            const type = document.getElementById('editType').value;
            
            const title = document.getElementById('editTitle').value.trim();
            const image = document.getElementById('editImageUrl').value.trim();
            
            if (!title || !image) {
                showMessage('Title and Image URL are required!', 'error');
                return;
            }
            
            const data = {
                title: title,
                image: image,
                description: document.getElementById('editDescription').value.trim() || '',
                category: document.getElementById('editCategory').value.trim() || '',
                language: document.getElementById('editLanguage').value.split(',').map(l => l.trim()).filter(l => l),
                year: document.getElementById('editYear').value ? parseInt(document.getElementById('editYear').value) : null,
                rating: document.getElementById('editRating').value.trim() || '',
                duration: document.getElementById('editDuration').value.trim() || '',
                videoUrl: document.getElementById('editVideoUrl').value.trim() || '',
                featured: document.getElementById('editFeatured').checked || false
            };
            
            const saveBtn = document.querySelector('#editForm .btn-primary');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '‚è≥ Saving...';
            saveBtn.disabled = true;
            
            try {
                console.log('Updating content with:', data);
                
                const response = await fetch(`${API_URL}/${type}/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('Update success:', result);
                    
                    document.getElementById('editForm').innerHTML = `
                        <div style="text-align: center; padding: 40px 20px; color: #4CAF50;">
                            <div style="font-size: 48px; margin-bottom: 20px;">‚úÖ</div>
                            <h3>Content Updated Successfully!</h3>
                            <p style="margin: 15px 0; color: #999;">"${data.title}" has been updated.</p>
                            <button class="btn" onclick="closeEditModal()" 
                                    style="background: #667eea; padding: 10px 20px; margin-top: 20px;">
                                Close
                            </button>
                        </div>
                    `;
                    
                    setTimeout(() => {
                        closeEditModal();
                        loadContent();
                        loadStats();
                        showMessage('‚úÖ Content updated successfully!', 'success');
                    }, 1500);
                    
                } else {
                    const errorData = await response.json().catch(() => ({ error: `HTTP ${response.status}` }));
                    throw new Error(errorData.error || errorData.message || 'Update failed');
                }
                
            } catch (error) {
                console.error('Error updating content:', error);
                
                saveBtn.innerHTML = '‚ùå Error - Try Again';
                setTimeout(() => {
                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                }, 2000);
                
                showMessage(`‚ùå Error: ${error.message}`, 'error');
            }
        }

        // ==================== DELETE CONTENT ====================
        async function deleteContent(id, type) {
            if (!confirm('Are you sure you want to delete this content? This action cannot be undone.')) return;
            
            try {
                const response = await fetch(`${API_URL}/${type}/${id}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showMessage('‚úÖ Content deleted successfully!', 'success');
                    loadContent();
                    loadStats();
                } else {
                    const errorData = await response.json();
                    showMessage(`‚ùå Error: ${errorData.error || 'Failed to delete'}`, 'error');
                }
            } catch (error) {
                console.error('Error deleting content:', error);
                showMessage('‚ùå Error deleting content', 'error');
            }
        }

        // ==================== UTILITY FUNCTIONS ====================
        function showMessage(message, type = 'success') {
            const messageEl = document.getElementById(type === 'success' ? 'successMessage' : 'errorMessage');
            messageEl.textContent = message;
            messageEl.style.display = 'block';
            
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 5000);
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
        }

        // ==================== SETUP EVENT LISTENERS ====================
        function setupEventListeners() {
            // Tab navigation
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(btn.dataset.tab).classList.add('active');
                    if (btn.dataset.tab === 'dashboard') {
                        loadStats();
                    } else if (btn.dataset.tab === 'manage') {
                        loadContent();
                    }
                });
            });
        }

        // ==================== TEST DATA FUNCTIONS ====================
        function fillTestData(type) {
            document.getElementById('contentType').value = type;
            document.getElementById('contentType').dispatchEvent(new Event('change'));
            
            if (type === 'movies') {
                document.getElementById('title').value = 'Avengers: Endgame';
                document.getElementById('imageUrl').value = 'https://m.media-amazon.com/images/M/MV5BMTc5MDE2ODcwNV5BMl5BanBnXkFtZTgwMzI2NzQ2NzM@._V1_FMjpg_UX1000_.jpg';
                document.getElementById('description').value = 'After the devastating events of Avengers: Infinity War, the universe is in ruins. With the help of remaining allies, the Avengers assemble once more in order to reverse Thanos actions and restore balance to the universe.';
                document.getElementById('year').value = '2019';
                document.getElementById('rating').value = '8.4';
                document.getElementById('duration').value = '3h 2m';
                document.getElementById('download480p').value = 'https://example.com/avengers-480p.mp4';
                document.getElementById('download720p').value = 'https://example.com/avengers-720p.mp4';
                document.getElementById('download1080p').value = 'https://example.com/avengers-1080p.mp4';
                document.getElementById('featured').checked = true;
                
                // Set categories
                selectedCategories = ['Action', 'Sci-Fi', 'Adventure'];
                document.querySelectorAll('#categoryCheckboxGroup input[type="checkbox"]').forEach(cb => {
                    cb.checked = selectedCategories.includes(cb.value);
                });
                updateCategoryTags();
                
                // Set languages
                document.querySelector('#lang-english').checked = true;
                
            } else if (type === 'anime') {
                document.getElementById('title').value = 'Attack on Titan';
                document.getElementById('imageUrl').value = 'https://m.media-amazon.com/images/M/MV5BMTY5ODk1NzUyMl5BMl5BanBnXkFtZTgwMjUyNzEyMTE@._V1_FMjpg_UX1000_.jpg';
                document.getElementById('description').value = 'After his hometown is destroyed and his mother is killed, young Eren Jaeger vows to cleanse the earth of the giant humanoid Titans that have brought humanity to the brink of extinction.';
                document.getElementById('year').value = '2013';
                document.getElementById('rating').value = '9.0';
                document.getElementById('duration').value = '24m per episode';
                document.getElementById('seasons').value = '4';
                document.getElementById('totalEpisodes').value = '75';
                document.getElementById('season1Zip480p').value = 'https://example.com/aot-season1-480p.zip';
                document.getElementById('season1Zip480pSize').value = '5.8';
                document.getElementById('season1Zip480pSizeUnit').value = 'GB';
                document.getElementById('completeZip480p').value = 'https://example.com/aot-complete-480p.zip';
                document.getElementById('completeZip480pSize').value = '25';
                document.getElementById('completeZip480pSizeUnit').value = 'GB';
                document.getElementById('featured').checked = true;
                
                // Set categories
                selectedCategories = ['Action', 'Drama', 'Fantasy'];
                document.querySelectorAll('#categoryCheckboxGroup input[type="checkbox"]').forEach(cb => {
                    cb.checked = selectedCategories.includes(cb.value);
                });
                updateCategoryTags();
                
                // Set languages
                document.querySelector('#lang-japanese').checked = true;
                document.querySelector('#lang-english').checked = true;
                
                // Add episodes
                document.getElementById('episodesContainer').innerHTML = '';
                episodeCounter = 0;
                addEpisode();
                document.getElementById('ep1-480p').value = 'https://example.com/aot-ep1-480p.mp4';
                document.getElementById('ep1-720p').value = 'https://example.com/aot-ep1-720p.mp4';
                
            } else if (type === 'webseries') {
                document.getElementById('title').value = 'Money Heist';
                document.getElementById('imageUrl').value = 'https://m.media-amazon.com/images/M/MV5BODI0ZTljYTMtODQ1NC00NmI0LTk1YWUtN2FlNDM1MDExMDlhXkEyXkFqcGdeQXVyMTM0NTUzNDIy._V1_FMjpg_UX1000_.jpg';
                document.getElementById('description').value = 'A criminal mastermind who goes by "The Professor" has a plan to pull off the biggest heist in recorded history -- to print billions of euros in the Royal Mint of Spain.';
                document.getElementById('year').value = '2017';
                document.getElementById('rating').value = '8.2';
                document.getElementById('duration').value = '45m per episode';
                document.getElementById('seasons').value = '5';
                document.getElementById('totalEpisodes').value = '41';
                document.getElementById('season1Zip480p').value = 'https://example.com/moneyheist-s1-480p.zip';
                document.getElementById('season1Zip480pSize').value = '8.5';
                document.getElementById('season1Zip480pSizeUnit').value = 'GB';
                document.getElementById('completeZip720p').value = 'https://example.com/moneyheist-complete-720p.zip';
                document.getElementById('completeZip720pSize').value = '45';
                document.getElementById('completeZip720pSizeUnit').value = 'GB';
                document.getElementById('featured').checked = true;
                
                // Set categories
                selectedCategories = ['Action', 'Thriller', 'Drama', 'Crime'];
                document.querySelectorAll('#categoryCheckboxGroup input[type="checkbox"]').forEach(cb => {
                    cb.checked = selectedCategories.includes(cb.value);
                });
                updateCategoryTags();
                
                // Set languages
                document.querySelector('#lang-spanish').checked = true;
                document.querySelector('#lang-english').checked = true;
                
                // Add episodes
                document.getElementById('episodesContainer').innerHTML = '';
                episodeCounter = 0;
                addEpisode();
                document.getElementById('ep1-480p').value = 'https://example.com/mh-s1e1-480p.mp4';
                document.getElementById('ep1-720p').value = 'https://example.com/mh-s1e1-720p.mp4';
                addEpisode();
                document.getElementById('ep2-480p').value = 'https://example.com/mh-s1e2-480p.mp4';
                document.getElementById('ep2-720p').value = 'https://example.com/mh-s1e2-720p.mp4';
            }
            
            updateImagePreview();
        }
    </script>
</body>
</html>